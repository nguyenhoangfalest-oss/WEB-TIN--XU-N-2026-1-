
<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Xuân 12A1 • Dashboard</title>

  <style>
    :root{
      --line:rgba(255,255,255,.18);
      --text:#fff3f7;
      --muted:#ffe0ec;
      --gold:#ffd700;
      --radius:26px;
      --btn:#ffd700;
      --btn2:#5c0014;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Times New Roman", Times, serif;
      background: url("../mini game/bau.png") no-repeat center center fixed;
      background-size: 100%;
      background-position: 70% 35%;
      color:var(--text);
      min-height:100vh;
      padding:26px;
      position:relative;
    }
    body::before{
      content:"";
      position:fixed;
      inset:0;
      background: rgba(120,0,0,0.42);
      backdrop-filter: blur(2px);
      z-index:0;
    }
    .wrap{
      position:relative;
      z-index:2;
      width:min(1100px,100%);
      margin:0 auto;
      display:grid;
      grid-template-columns: 360px 1fr;
      gap:18px;
    }
    @media (max-width:900px){ .wrap{grid-template-columns:1fr} }

    .card{
      background: linear-gradient(180deg, rgba(179,0,59,.92), rgba(139,0,0,.92));
      border:3px solid var(--gold);
      border-radius:var(--radius);
      padding:18px;
      box-shadow:0 18px 55px rgba(0,0,0,.45);
      position:relative;
    }
    h1,h2{margin:0;color:var(--gold);font-weight:900}
    h1{font-size:34px}
    h2{font-size:22px;margin-bottom:10px}
    .muted{color:var(--muted)}
    .row{display:flex; gap:12px; flex-wrap:wrap; align-items:center}
    .spacer{height:12px}

    .avatarBox{
      display:flex; gap:14px; align-items:center;
      padding:14px;
      border:2px solid var(--gold);
      border-radius:18px;
      background:rgba(255,255,255,.08);
    }
    .avatar{
      width:86px; height:86px;
      border-radius:50%;
      border:3px solid var(--gold);
      object-fit:cover;
      background:rgba(255,255,255,.15);
    }

    /* ✅ Email nhỏ + không phá layout */
    .emailSmall{
      font-size:13px;
      color:var(--muted);
      opacity:.95;
      max-width:210px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    @media (max-width:900px){
      .emailSmall{max-width:100%;}
    }

    label{display:block; margin-top:12px}
    label span{display:block; font-weight:900; color:var(--muted); margin-bottom:8px; font-size:17px}
    input, textarea{
      width:100%;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.12);
      color:var(--text);
      outline:none;
      font-size:18px;
      font-family:"Times New Roman", Times, serif;
    }
    textarea{min-height:120px; resize:vertical}

    button{
      border:0;
      border-radius:16px;
      padding:12px 16px;
      font-weight:900;
      cursor:pointer;
      font-size:18px;
      font-family:"Times New Roman", Times, serif;
      outline:2px solid transparent;
      outline-offset:3px;
      transition: transform .14s ease, box-shadow .14s ease, outline-color .14s ease;
    }
    button:hover{
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 14px 28px rgba(0,0,0,.28);
      outline-color: rgba(255,215,0,.55);
    }
    .btn{background:var(--btn); color:#7a0000;}
    .btn.secondary{background:var(--btn2); color:var(--text); border:1px solid var(--line)}

    .stats{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:12px;
      margin-top:12px;
    }
    .stat{
      background:rgba(255,255,255,.09);
      border:1px solid rgba(255,215,0,.35);
      border-radius:18px;
      padding:12px;
    }
    .stat .k{color:var(--muted); font-weight:900}
    .stat .v{font-size:26px; font-weight:900; color:var(--gold); margin-top:4px}

    .notifItem{
      padding:12px;
      border-radius:16px;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      margin-top:10px;
    }
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:18px;
    }
    .web-logo{
      position:fixed;
      top:18px;
      left:22px;
      font-size:38px;
      z-index:999;
      animation: floatLogo 3s ease-in-out infinite;
    }
    @keyframes floatLogo{0%{transform:translateY(0px);}50%{transform:translateY(-6px);}100%{transform:translateY(0px);}}

    /* =======================
       MODAL CROP AVATAR
    ======================= */
    .modal{
      position:fixed;
      inset:0;
      display:none;
      place-items:center;
      background:rgba(0,0,0,.55);
      z-index:9999;
      padding:18px;
    }
    .modal.show{display:grid;}
    .modalCard{
      width:min(680px,100%);
      background: linear-gradient(180deg, rgba(179,0,59,.96), rgba(139,0,0,.96));
      border:3px solid var(--gold);
      border-radius:22px;
      padding:16px;
      box-shadow:0 18px 55px rgba(0,0,0,.55);
    }
    .modalTop{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:10px;
    }
    .cropWrap{
      display:grid;
      grid-template-columns: 1fr 220px;
      gap:14px;
      align-items:start;
    }
    @media (max-width:800px){
      .cropWrap{grid-template-columns:1fr;}
    }
    .cropStage{
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,215,0,.25);
      border-radius:18px;
      padding:12px;
    }
    .cropCanvas{
      width:100%;
      aspect-ratio: 1 / 1;
      background:rgba(255,255,255,.06);
      border-radius:16px;
      border:1px dashed rgba(255,215,0,.35);
      display:block;
      touch-action:none;
      cursor:grab;
    }
    .sideBox{
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,215,0,.25);
      border-radius:18px;
      padding:12px;
    }
    .preview{
      width:140px;height:140px;
      border-radius:50%;
      border:3px solid var(--gold);
      object-fit:cover;
      background:rgba(255,255,255,.12);
      display:block;
      margin:0 auto 10px;
    }
    .range{
      width:100%;
    }
  </style>
</head>

<body>
  <div class="web-logo">🌸</div>

<div class="topbar" style="position:relative; z-index:2; width:min(1100px,100%); margin:0 auto 18px;">
  <h1>🎊 Thông tin người dùng </h1>

  <div class="row">
    <button id="btnHome" class="btn">Trang chủ</button>
    <button id="btnLogout" class="btn secondary">Đăng xuất</button>
  </div>
</div>


  <div class="wrap">
    <!-- LEFT -->
    <section class="card">
      <h2>Thông tin người dùng</h2>

      <div class="avatarBox">
        <img id="avatar" class="avatar" alt="avatar">
        <div>
          <div id="name" style="font-size:22px; font-weight:900; color:var(--gold);">—</div>
          <div id="email" class="emailSmall">—</div>
        </div>
      </div>

      <label>
        <span>Đổi tên hiển thị</span>
        <input id="displayName" placeholder="VD: Trần Văn B">
      </label>

      <label>
        <span>Avatar emoji</span>
        <input id="avatarEmoji" placeholder="VD: 🌸">
      </label>

      <label>
        <span>Đổi avatar (chọn ảnh)</span>
        <input id="avatarFile" type="file" accept="image/*">
      </label>

      <div class="row" style="margin-top:12px;">
        <button id="btnSaveProfile" class="btn">Lưu hồ sơ</button>
        <button id="btnResetAvatar" class="btn secondary">Avatar mặc định</button>
      </div>

      <div id="msg" class="muted" style="margin-top:12px; min-height:22px;"></div>
    </section>

    <!-- RIGHT -->
    <section class="card">
      <h2>Trạng thái & Thành tích</h2>

      <!-- ✅ BỎ NÚT +/- : chỉ hiển thị realtime -->
      <div class="stats">
        <div class="stat">
          <div class="k">Số 🪙</div>
          <div id="coins" class="v">0</div>
          <div class="muted" style="margin-top:6px;font-size:14px;">(Cập nhật tự động)</div>
        </div>

        <div class="stat">
          <div class="k">Lượt tương tác</div>
          <div id="interactions" class="v">0</div>
          <div class="muted" style="margin-top:6px;font-size:14px;">(Cập nhật tự động)</div>
        </div>
      </div>

      <div class="spacer"></div>

      <!-- ✅ Thành tích chỉ hiển thị, không edit ở dashboard -->
      <label>
        <span>Thành tích</span>
        <textarea id="achievement" placeholder="(Sẽ hiển thị thành tích cá nhân)" readonly></textarea>
      </label>

      <div class="spacer"></div>

      <h2>Thông báo</h2>
      <div id="notifList"></div>

      <label>
        <span>Thêm thông báo mới</span>
        <input id="notifText" placeholder="VD: 20h tối nay chơi lô tô phòng 12A1!">
      </label>
      <div class="row" style="margin-top:12px;">
        <button id="btnAddNotif" class="btn">Đăng thông báo</button>
        <button id="btnClearNotif" class="btn secondary">Xóa hết</button>
      </div>
    </section>
  </div>

  <!-- ✅ MODAL CROP -->
  <div id="cropModal" class="modal" aria-hidden="true">
    <div class="modalCard">
      <div class="modalTop">
        <h2 style="margin:0;">Cắt ảnh Avatar</h2>
        <button id="btnCropClose" class="btn secondary">Đóng</button>
      </div>

      <div class="cropWrap">
        <div class="cropStage">
          <div class="muted" style="margin-bottom:10px;">
            Kéo ảnh để canh mặt. Dùng thanh Zoom để phóng/thu.
          </div>
          <canvas id="cropCanvas" class="cropCanvas" width="600" height="600"></canvas>
        </div>

        <div class="sideBox">
          <img id="cropPreview" class="preview" alt="preview">
          <label style="margin:0;">
            <span>Zoom</span>
            <input id="zoomRange" class="range" type="range" min="1" max="3" step="0.01" value="1.2">
          </label>

          <div class="row" style="margin-top:12px;">
            <button id="btnCropApply" class="btn">Dùng ảnh này</button>
            <button id="btnCropReset" class="btn secondary">Reset</button>
          </div>

          <div class="muted" style="margin-top:10px;font-size:14px;">
            Ảnh sẽ được cắt hình vuông và hiển thị tròn khi lưu.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="dashboard.js"></script>
  <script type="module" src="fx.js"></script>
</body>
</html>


